{% extends 'base.html' %} {% block title %}Dashboard - VaccinationTracker{% endblock %} {% block content %}
<div id="profilesDashboard" class="dashboard max-w-[800px] mx-auto vt-dashboard">
    <!-- <div class="flex items-center justify-between mb-3">
        <h2 class="text-xl font-bold text-gray-800">Children Schedule</h2>
        <div class="flex items-center gap-2">
            <a
                href="{{ url_for('views.add_child') }}"
                id="addChildBtn"
                class="flex gap-3 justify-center items-center text-blue-600 bg-blue-50 border-2 border-blue-200 px-3 py-2 rounded-md hover:bg-blue-700 hover:text-white text-base"
            >
                <span class="material-symbols-outlined"> person_add </span>
                Add Child
            </a>
            <a
                href="{{ url_for('views.home') }}"
                id="backToScheduleBtn"
                class="flex gap-3 justify-center items-center text-gray-600 bg-gray-50 border-2 border-gray-200 px-3 py-2 rounded-md hover:bg-gray-200 text-base"
            >
                <span class="material-symbols-outlined"> arrow_back </span>
                Back
            </a>
        </div>
    </div> -->

    <!-- Stats overview -->
    <div class="stats-grid vt-stats-grid">
        <div class="stat-card vt-stat-card">
            <div class="stat-title">Total Children</div>
            <div id="statTotal" class="stat-value">{{ children|length }}</div>
        </div>
        <div class="stat-card vt-stat-card">
            <div class="stat-title">Completed</div>
            <div id="statCompleted" class="stat-value">{{ overall_completed }}</div>
        </div>
        <div class="stat-card vt-stat-card">
            <div class="stat-title">Overdue</div>
            <div id="statOverdue" class="stat-value text-red-600">{{ overall_overdue }}</div>
        </div>
        <div class="stat-card vt-stat-card">
            <div class="stat-title">Upcoming / Due Soon</div>
            <div id="statUpcoming" class="stat-value text-blue-600">{{ overall_upcoming }}</div>
        </div>
    </div>

    <!-- Profiles list -->
    <div id="profilesList" class="space-y-2 mt-4 vt-profiles-list">
        {% if not children %}
        <div class="text-sm text-gray-600 p-3">No profiles yet. Add a child to get started.</div>
        {% else %} {% for s in child_stats %}
        <div class="profile-card vt-profile-card">
            <div class="flex !w-full flex-col">
                <div class="flex items-center justify-between gap-2 flex-wrap">
                    <div class="flex gap-4 items-baseline">
                        <span class="!text-2xl font-semibold text-gray-800">{{ s.child.name }}</span>
                        <span class="!text-sm text-gray-600"
                            ><strong>Born:</strong> {{ s.child.dob|friendly_date }}</span
                        >
                    </div>
                    <div class="flex items-center gap-2">
                        <span
                            class="px-3 py-1 text-sm font-medium text-red-600 bg-red-50 border border-red-200 rounded-full"
                            >{{ s.overdue }} Overdue</span
                        >
                        <span
                            class="px-3 py-1 text-sm font-medium text-yellow-600 bg-yellow-50 border border-yellow-200 rounded-full"
                            >{{ s.due_soon }} Due Soon</span
                        >
                        <span
                            class="px-3 py-1 text-sm font-medium text-green-600 bg-green-50 border border-green-200 rounded-full"
                            >{{ s.completed }}/{{ s.total }} Complete</span
                        >
                    </div>
                </div>
                <div class="mt-3 bg-blue-50 text-blue-900 rounded-md p-3">
                    <div class="text-sm">
                        <strong>Next Due:</strong> {{ s.next_due|friendly_date if s.next_due else 'N/A' }}
                    </div>
                    <div class="text-lg">
                        {{ s.next_due_vaccines|join(', ') if s.next_due_vaccines else 'All done' }}
                    </div>
                </div>
            </div>
            <div class="flex flex-1 flex-col !w-full items-center gap-2 ml-3">
                <a
                    href="{{ url_for('views.child_view', child_id=s.child.id) }}"
                    class="flex flex-row justify-center items-center gap-1 !w-full view-btn bg-gray-100 text-gray-800 px-3 py-1 rounded-md text-sm hover:bg-gray-200"
                >
                    <span class="material-symbols-outlined">read_more</span>
                    View
                </a>
                <form
                    method="POST"
                    action="{{ url_for('views.delete_child', child_id=s.child.id) }}"
                    class="w-full"
                    onsubmit="return confirm('Delete {{ s.child.name }} and all vaccination records? This cannot be undone.');"
                >
                    <button
                        type="submit"
                        class="flex flex-row justify-center items-center gap-1 w-full bg-red-600 text-white px-3 py-1 rounded-md text-sm hover:bg-red-700"
                    >
                        <span class="material-symbols-outlined">delete</span>
                        Delete
                    </button>
                </form>
            </div>
        </div>
        {% endfor %} {% endif %}
    </div>
</div>
{% endblock %}
