<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{% block title %}VaccinationTracker - Child Vaccination Schedule{% endblock %}</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        />
        <!-- Core Styles -->
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
        <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}" />
        <!-- PWA Meta Tags -->
        <meta name="theme-color" content="#3b82f6" />
        <meta name="description" content="Track your child's vaccination schedule with ease" />
        <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}" />
        {% block extra_head %}{% endblock %}
    </head>
    <body class="gradient-bg min-h-screen py-8 vt-body layout-fab">
        <div class="mx-auto px-[1.5rem] vt-layout">
            <!-- Floating Action Button + Menu -->
            <div id="fabContainer" class="vt-fab">
                <!-- Popup action list (reuses id=topActions for continuity) -->
                <div id="topActions" class="fab-menu hidden" role="menu" aria-label="Quick actions">
                    <div class="fab-menu-group">
                        <a href="{{ url_for('views.dashboard') }}" class="fab-item" role="menuitem">
                            <span class="material-symbols-outlined"> dashboard </span>
                            <span class="label">Dashboard</span>
                        </a>
                        <a href="{{ url_for('views.add_child') }}" class="fab-item" role="menuitem">
                            <span class="material-symbols-outlined"> person_add </span>
                            <span class="label">Add Child</span>
                        </a>
                    </div>

                    {% if current_parent %}
                    <div class="fab-menu-group">
                        <a
                            href="{{ url_for('auth.parent_profile', parent_id=current_parent.id) }}"
                            class="fab-item"
                            role="menuitem"
                        >
                            <span class="material-symbols-outlined"> account_circle </span>
                            <span class="label">Profile</span>
                        </a>
                        <a href="{{ url_for('auth.logout') }}" class="fab-item" role="menuitem">
                            <span class="material-symbols-outlined"> logout </span>
                            <span class="label">Logout</span>
                        </a>
                    </div>
                    {% else %}
                    <div class="fab-menu-group">
                        <a href="{{ url_for('auth.login') }}" class="fab-item" role="menuitem">
                            <span class="material-symbols-outlined"> login </span>
                            <span class="label">Login</span>
                        </a>
                        <a href="{{ url_for('auth.register') }}" class="fab-item" role="menuitem">
                            <span class="material-symbols-outlined"> how_to_reg </span>
                            <span class="label">Register</span>
                        </a>
                    </div>
                    {% endif %}
                </div>
                <button
                    id="fabToggle"
                    class="fab-btn bg-gray-50 hover:bg-gray-200"
                    aria-haspopup="true"
                    aria-expanded="false"
                    aria-controls="topActions"
                    title="Quick actions"
                >
                    <span id="fabIcon" class="material-symbols-outlined"> add </span>
                </button>
            </div>

            <!-- Header -->
            <header class="text-center mb-8 vt-header">
                <h1 class="text-5xl font-bold text-gray-800 mb-4 vt-page-title">Child Vaccination Tracker</h1>
                <div class="flex justify-between items-center max-w-[720px] mx-auto vt-container-narrow">
                    <a
                        href="https://iapindia.org/pdf/Indian-Pediatrics/2024/Indian-Pediatrics-February-2024-issue.pdf"
                        class="text-gray-600 text-lg hover:underline vt-subtitle"
                        >Based on IAP 2024 Schedule</a
                    >
                    <p class="text-lg font-medium text-gray-700 m-0 p-0 vt-subtitle">
                        Country: <span class="font-semibold text-gray-800">India</span>
                    </p>
                </div>
            </header>

            {% block content %}{% endblock %}
        </div>

        <!-- FAB behavior -->
        <script>
            (function () {
                const toggle = document.getElementById("fabToggle");
                const menu = document.getElementById("topActions");
                const icon = document.getElementById("fabIcon");

                if (!toggle || !menu) return;

                const openMenu = () => {
                    menu.classList.remove("hidden");
                    menu.classList.add("open");
                    toggle.setAttribute("aria-expanded", "true");
                    if (icon) icon.textContent = "close";
                };
                const closeMenu = () => {
                    menu.classList.add("hidden");
                    menu.classList.remove("open");
                    toggle.setAttribute("aria-expanded", "false");
                    if (icon) icon.textContent = "add";
                };
                const toggleMenu = (e) => {
                    if (e) e.stopPropagation();
                    if (menu.classList.contains("hidden")) openMenu();
                    else closeMenu();
                };

                toggle.addEventListener("click", toggleMenu);
                document.addEventListener("click", (e) => {
                    if (!menu.contains(e.target) && e.target !== toggle) {
                        closeMenu();
                    }
                });
                document.addEventListener("keydown", (e) => {
                    if (e.key === "Escape") closeMenu();
                });
            })();
        </script>

        {% block scripts %} {% endblock %}
    </body>
</html>
